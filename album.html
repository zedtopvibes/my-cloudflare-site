<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Album | Zedtopvibes</title>
</head>
<body>
    <div class="main-content-container" id="content">
        <div style="text-align: center; padding: 60px; width: 100%;">Loading album...</div>
    </div>

    <script type="module">
        import { API_BASE, formatNumber, formatDuration } from '/js/shared/helpers.js';
        import { goToArtist, goToSong, goToAlbum } from '/js/shared/navigation.js';
        import { fetchAlbum } from '/js/shared/api.js';
        import { injectTemplates, loadTemplate } from '/js/shared/template-loader.js';

        const urlParams = new URLSearchParams(window.location.search);
        const albumId = urlParams.get('id');
        const contentDiv = document.getElementById('content');
        const albumSlug = contentDiv?.dataset.albumSlug;

        let albumIdentifier = albumSlug || albumId;
        let useSlug = !!albumSlug;

        async function loadAlbum() {
            if (!albumIdentifier) {
                document.getElementById('content').innerHTML = '<div style="text-align: center; padding: 60px;">No album specified</div>';
                return;
            }

            try {
                const skeleton = await loadTemplate('loading-skeleton');
                document.getElementById('content').innerHTML = skeleton;

                const apiUrl = useSlug 
                    ? `${API_BASE}/album/by-slug/${albumIdentifier}`
                    : `${API_BASE}/albums/${albumIdentifier}`;

                const response = await fetch(apiUrl);
                if (!response.ok) throw new Error('Album not found');
                
                const data = await response.json();
                renderAlbum(data);

            } catch (error) {
                document.getElementById('content').innerHTML = `<div style="text-align: center; padding: 60px;">Error: ${error.message}</div>`;
            }
        }

        function renderAlbum(album) {
            const tracks = album.tracks || [];
            // ... rest of your album rendering logic
            // (copy from your existing album.html)
        }

        async function initPage() {
            await injectTemplates();
            const footerHtml = await loadTemplate('footer');
            document.body.insertAdjacentHTML('beforeend', footerHtml);
            await loadAlbum();
        }

        initPage();
        window.goToArtist = goToArtist;
        window.goToSong = goToSong;
        window.goToAlbum = goToAlbum;
    </script>
</body>
</html>